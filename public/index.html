<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì˜¤ì„±ì¤‘í•™êµ ë™ì•„ë¦¬ í¸ì„± ì‹œìŠ¤í…œ</title>
    
    <!-- SEO ë©”íƒ€íƒœê·¸ -->
    <meta name="description" content="ì˜¤ì„±ì¤‘í•™êµ 2025í•™ë…„ë„ ì°½ì²´ë™ì•„ë¦¬ ì‹ ì²­ ë° í¸ì„± ê´€ë¦¬ ì‹œìŠ¤í…œ">
    <meta name="keywords" content="ì˜¤ì„±ì¤‘í•™êµ, ë™ì•„ë¦¬, í¸ì„±, ì‹ ì²­, ì¤‘í•™êµ">
    <meta name="author" content="ì˜¤ì„±ì¤‘í•™êµ">
    
    <!-- íŒŒë¹„ì½˜ -->
    <link rel="icon" type="image/x-icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸ“</text></svg>">
    
    <!-- í”„ë¡œë•ì…˜ìš© Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- React & ReactDOM CDN -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Babel Standalone (ì¡°ê±´ë¶€ ë¡œë“œë¡œ ê°œì„ ) -->
    <script>
        // í”„ë¡œë•ì…˜ì—ì„œëŠ” Babel ì‚¬ìš©ì„ ìµœì†Œí™”
        const isDev = window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1';
        if (isDev || !window.React || !window.ReactDOM) {
            document.write('<script src="https://unpkg.com/@babel/standalone/babel.min.js"><\/script>');
        }
    </script>
    
    <!-- Chart.js CDN -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.js"></script>
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&display=swap');
        
        :root {
            --primary-blue: #3b82f6;
            --primary-blue-hover: #2563eb;
            --success-green: #10b981;
            --warning-yellow: #f59e0b;
            --error-red: #ef4444;
        }
        
        body {
            font-family: 'Noto Sans KR', sans-serif;
            line-height: 1.6;
        }
        
        .loading-spinner {
            border: 4px solid #f3f4f6;
            border-top: 4px solid var(--primary-blue);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .bounce-in {
            animation: bounceIn 0.6s ease-out;
        }
        
        @keyframes bounceIn {
            0% { transform: scale(0.3); opacity: 0; }
            50% { transform: scale(1.05); }
            70% { transform: scale(0.9); }
            100% { transform: scale(1); opacity: 1; }
        }
        
        .club-card {
            transition: all 0.3s ease;
            cursor: pointer;
            transform: translateZ(0);
        }
        
        .club-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        }
        
        .progress-bar {
            transition: width 0.5s ease-in-out;
        }
        
        .modal-backdrop {
            backdrop-filter: blur(5px);
        }
        
        .notification {
            animation: slideInRight 0.5s ease-out;
        }
        
        @keyframes slideInRight {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        .tab-active {
            background-color: white;
            color: var(--primary-blue);
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }
        
        .tab-inactive {
            color: #6b7280;
        }

        .error-boundary {
            border: 2px solid var(--error-red);
            background-color: #fef2f2;
            padding: 1rem;
            border-radius: 0.5rem;
            color: #dc2626;
        }

        .connection-status {
            position: fixed;
            top: 1rem;
            left: 1rem;
            z-index: 1000;
            padding: 0.5rem 1rem;
            border-radius: 9999px;
            font-size: 0.875rem;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .connection-online {
            background-color: #dcfce7;
            color: #166534;
        }

        .connection-offline {
            background-color: #fee2e2;
            color: #991b1b;
        }

        .connection-checking {
            background-color: #fef3c7;
            color: #92400e;
        }

        /* ì ‘ê·¼ì„± ê°œì„  */
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }

        /* ë‹¤í¬ëª¨ë“œ ëŒ€ì‘ (ì„ íƒì‚¬í•­) */
        @media (prefers-color-scheme: dark) {
            .bg-gray-50 { background-color: #1f2937; }
            .text-gray-800 { color: #f9fafb; }
            .text-gray-600 { color: #d1d5db; }
        }

        /* ëª¨ë°”ì¼ ìµœì í™” */
        @media (max-width: 640px) {
            .club-card {
                margin-bottom: 1rem;
            }
            
            .notification {
                left: 1rem;
                right: 1rem;
                max-width: none;
            }
        }

        /* í…ìŠ¤íŠ¸ ë¼ì¸ í´ë¨í”„ */
        .line-clamp-2 {
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        /* ì¶”ê°€: í”„ë¡œë•ì…˜ ìµœì í™” */
        .preload-content {
            content-visibility: auto;
            contain-intrinsic-size: 300px;
        }
        
        /* ìŠ¤ì¼ˆë ˆí†¤ ë¡œë”© */
        .skeleton {
            animation: skeleton-pulse 1.5s ease-in-out infinite alternate;
            background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
            background-size: 200% 100%;
        }
        
        @keyframes skeleton-pulse {
            0% { background-position: 200% 0; }
            100% { background-position: -200% 0; }
        }
    </style>
</head>
<body class="bg-gray-50">
    <!-- ì—°ê²° ìƒíƒœ í‘œì‹œ -->
    <div id="connection-status" class="connection-status connection-checking" style="display: none;">
        <i class="fas fa-circle-notch fa-spin mr-1"></i>
        <span>ì—°ê²° í™•ì¸ ì¤‘...</span>
    </div>

    <!-- Skip to content for accessibility -->
    <a href="#main-content" class="sr-only focus:not-sr-only focus:absolute focus:top-4 focus:left-4 bg-blue-600 text-white px-4 py-2 rounded">
        ë©”ì¸ ì½˜í…ì¸ ë¡œ ë°”ë¡œê°€ê¸°
    </a>

    <!-- ë©”ì¸ ì• í”Œë¦¬ì¼€ì´ì…˜ -->
    <div id="root" role="main">
        <!-- ë¡œë”© ì¤‘ì¼ ë•Œ í‘œì‹œë  ê¸°ë³¸ UI -->
        <div class="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center">
            <div class="text-center" role="status" aria-live="polite">
                <div class="loading-spinner mx-auto mb-4" aria-hidden="true"></div>
                <p class="text-gray-600 text-lg">ì˜¤ì„±ì¤‘í•™êµ ë™ì•„ë¦¬ ì‹œìŠ¤í…œ</p>
                <p class="text-sm text-gray-500 mt-2">ì‹œìŠ¤í…œì„ ì´ˆê¸°í™”í•˜ê³  ìˆìŠµë‹ˆë‹¤...</p>
                <div class="mt-4">
                    <div class="w-64 bg-gray-200 rounded-full h-2 mx-auto">
                        <div class="bg-blue-600 h-2 rounded-full animate-pulse" style="width: 70%"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ì—ëŸ¬ í´ë°± UI -->
    <div id="error-fallback" style="display: none;" class="min-h-screen bg-gray-50 flex items-center justify-center">
        <div class="error-boundary max-w-md text-center">
            <i class="fas fa-exclamation-triangle text-6xl text-red-500 mb-4"></i>
            <h1 class="text-2xl font-bold text-gray-800 mb-2">ì‹œìŠ¤í…œ ì˜¤ë¥˜</h1>
            <p class="text-gray-600 mb-6">ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ë¡œë“œí•˜ëŠ” ì¤‘ ë¬¸ì œê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.</p>
            <button 
                onclick="window.location.reload()" 
                class="px-6 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors"
            >
                <i class="fas fa-redo mr-2"></i>í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨
            </button>
        </div>
    </div>

    <!-- React ì• í”Œë¦¬ì¼€ì´ì…˜ ìŠ¤í¬ë¦½íŠ¸ -->
    <script type="text/babel">
        const { useState, useEffect, useRef, useCallback, useMemo } = React;

        // í™˜ê²½ ì„¤ì •
        const ENV = {
            isDevelopment: window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1',
            apiBase: window.location.origin,
            version: '1.0.1'
        };

        console.log('ğŸš€ ì˜¤ì„±ì¤‘í•™êµ ë™ì•„ë¦¬ ì‹œìŠ¤í…œ ì‹œì‘', { ENV, timestamp: new Date().toISOString() });

        // ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜ë“¤
        const utils = {
            debounce: (func, wait) => {
                let timeout;
                return function executedFunction(...args) {
                    const later = () => {
                        clearTimeout(timeout);
                        func(...args);
                    };
                    clearTimeout(timeout);
                    timeout = setTimeout(later, wait);
                };
            },
            
            formatDate: (date) => {
                return new Date(date).toLocaleDateString('ko-KR', {
                    year: 'numeric',
                    month: 'long',
                    day: 'numeric',
                    hour: '2-digit',
                    minute: '2-digit'
                });
            },

            // ì¶”ê°€: ì„±ëŠ¥ ìµœì í™” í•¨ìˆ˜
            throttle: (func, limit) => {
                let inThrottle;
                return function() {
                    const args = arguments;
                    const context = this;
                    if (!inThrottle) {
                        func.apply(context, args);
                        inThrottle = true;
                        setTimeout(() => inThrottle = false, limit);
                    }
                }
            }
        };

        // ì—°ê²° ìƒíƒœ ê´€ë¦¬
        const ConnectionStatus = () => {
            const [isOnline, setIsOnline] = useState(navigator.onLine);
            const [apiStatus, setApiStatus] = useState('checking');
            const [lastChecked, setLastChecked] = useState(null);

            const checkApiConnection = useCallback(async () => {
                try {
                    const controller = new AbortController();
                    const timeoutId = setTimeout(() => controller.abort(), 10000);
                    
                    const response = await fetch(`${ENV.apiBase}/api/health`, {
                        method: 'GET',
                        signal: controller.signal,
                        cache: 'no-cache'
                    });
                    
                    clearTimeout(timeoutId);
                    setApiStatus(response.ok ? 'online' : 'offline');
                    setLastChecked(new Date());
                } catch (error) {
                    console.warn('API connection check failed:', error);
                    setApiStatus('offline');
                    setLastChecked(new Date());
                }
            }, []);

            useEffect(() => {
                const handleOnline = () => {
                    setIsOnline(true);
                    checkApiConnection();
                };
                
                const handleOffline = () => {
                    setIsOnline(false);
                    setApiStatus('offline');
                };

                window.addEventListener('online', handleOnline);
                window.addEventListener('offline', handleOffline);
                
                // ì´ˆê¸° ì—°ê²° ìƒíƒœ í™•ì¸
                checkApiConnection();
                
                // ì£¼ê¸°ì  ì—°ê²° ìƒíƒœ ì²´í¬ (30ì´ˆë§ˆë‹¤)
                const interval = setInterval(checkApiConnection, 30000);

                return () => {
                    window.removeEventListener('online', handleOnline);
                    window.removeEventListener('offline', handleOffline);
                    clearInterval(interval);
                };
            }, [checkApiConnection]);

            // DOM ì—…ë°ì´íŠ¸
            useEffect(() => {
                const connectionElement = document.getElementById('connection-status');
                if (connectionElement) {
                    const isConnected = isOnline && apiStatus === 'online';
                    const isChecking = apiStatus === 'checking';
                    
                    connectionElement.style.display = 'flex';
                    connectionElement.style.alignItems = 'center';
                    
                    if (isChecking) {
                        connectionElement.className = 'connection-status connection-checking';
                        connectionElement.innerHTML = `
                            <i class="fas fa-circle-notch fa-spin mr-1"></i>
                            <span>ì—°ê²° í™•ì¸ ì¤‘...</span>
                        `;
                    } else if (isConnected) {
                        connectionElement.className = 'connection-status connection-online';
                        connectionElement.innerHTML = `
                            <i class="fas fa-wifi mr-1"></i>
                            <span>ì—°ê²°ë¨</span>
                        `;
                        
                        // 3ì´ˆ í›„ ìë™ ìˆ¨ê¹€
                        setTimeout(() => {
                            connectionElement.style.display = 'none';
                        }, 3000);
                    } else {
                        connectionElement.className = 'connection-status connection-offline';
                        connectionElement.innerHTML = `
                            <i class="fas fa-exclamation-triangle mr-1"></i>
                            <span>ì—°ê²° ëŠê¹€</span>
                        `;
                    }
                }
            }, [isOnline, apiStatus]);

            return null;
        };

        // ê°œì„ ëœ API ìœ í‹¸ë¦¬í‹°
        const api = {
            baseURL: ENV.apiBase,
            
            async request(endpoint, options = {}) {
                const token = localStorage.getItem('token');
                const config = {
                    headers: {
                        'Content-Type': 'application/json',
                        ...(token && { Authorization: `Bearer ${token}` })
                    },
                    timeout: 15000,
                    ...options
                };
                
                if (config.body && typeof config.body === 'object') {
                    config.body = JSON.stringify(config.body);
                }
                
                try {
                    const response = await fetch(`${this.baseURL}/api${endpoint}`, config);
                    
                    if (!response.ok) {
                        const errorData = await response.json().catch(() => ({}));
                        
                        // êµ¬ì²´ì ì¸ ì—ëŸ¬ ë©”ì‹œì§€ ì œê³µ
                        const errorMessages = {
                            401: 'ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤',
                            403: 'ì ‘ê·¼ ê¶Œí•œì´ ì—†ìŠµë‹ˆë‹¤',
                            404: 'ìš”ì²­í•œ ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤',
                            429: 'ë„ˆë¬´ ë§ì€ ìš”ì²­ì„ ë³´ëƒˆìŠµë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”',
                            500: 'ì„œë²„ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”',
                            502: 'ì„œë²„ê°€ ì¼ì‹œì ìœ¼ë¡œ ì´ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤',
                            503: 'ì„œë¹„ìŠ¤ê°€ ì¼ì‹œì ìœ¼ë¡œ ì¤‘ë‹¨ë˜ì—ˆìŠµë‹ˆë‹¤'
                        };
                        
                        const message = errorMessages[response.status] || errorData.error || `HTTP ${response.status}: ìš”ì²­ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤`;
                        throw new Error(message);
                    }
                    
                    return response.json();
                } catch (error) {
                    if (error.name === 'TypeError' && error.message.includes('fetch')) {
                        throw new Error('ì„œë²„ì— ì—°ê²°í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ë„¤íŠ¸ì›Œí¬ ìƒíƒœë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”');
                    }
                    if (error.name === 'AbortError') {
                        throw new Error('ìš”ì²­ì´ ì‹œê°„ ì´ˆê³¼ë˜ì—ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”');
                    }
                    throw error;
                }
            },
            
            // ì¸ì¦ ê´€ë ¨
            login: (username, password) => 
                api.request('/login', { method: 'POST', body: { username, password } }),
            register: (student_number, name) =>
                api.request('/register', { method: 'POST', body: { student_number, name } }),
            checkStudent: (student_number) =>
                api.request(`/check-student/${student_number}`),
            
            // ë™ì•„ë¦¬ ê´€ë ¨
            getClubs: () => api.request('/clubs'),
            getClub: (id) => api.request(`/clubs/${id}`),
            apply: (applications) => api.request('/apply', { method: 'POST', body: applications }),
            getMyApplications: () => api.request('/my-applications'),
            
            // ê´€ë¦¬ì API
            getAllApplications: () => api.request('/admin/applications'),
            assignClubs: () => api.request('/admin/assign-clubs', { method: 'POST' }),
            getAssignments: () => api.request('/admin/assignments'),

            // ì‹œìŠ¤í…œ ìƒíƒœ í™•ì¸
            checkHealth: () => api.request('/health'),
        };

        // ì—ëŸ¬ ë°”ìš´ë”ë¦¬ ì»´í¬ë„ŒíŠ¸
        class ErrorBoundary extends React.Component {
            constructor(props) {
                super(props);
                this.state = { hasError: false, error: null, errorInfo: null };
            }

            static getDerivedStateFromError(error) {
                return { hasError: true, error };
            }

            componentDidCatch(error, errorInfo) {
                console.error('ğŸš¨ ì—ëŸ¬ ë°”ìš´ë”ë¦¬ì—ì„œ ì—ëŸ¬ í¬ì°©:', error, errorInfo);
                this.setState({ errorInfo });
                
                // ì—ëŸ¬ ì •ë³´ë¥¼ ë¡œê·¸ë¡œ ì „ì†¡ (ì„ íƒì‚¬í•­)
                if (!ENV.isDevelopment) {
                    try {
                        console.error('Production Error:', {
                            error: error.message,
                            stack: error.stack,
                            componentStack: errorInfo.componentStack,
                            timestamp: new Date().toISOString(),
                            userAgent: navigator.userAgent,
                            url: window.location.href
                        });
                    } catch (e) {
                        console.error('Error logging failed:', e);
                    }
                }
            }

            render() {
                if (this.state.hasError) {
                    return (
                        <div className="min-h-screen bg-gray-50 flex items-center justify-center">
                            <div className="error-boundary max-w-lg text-center">
                                <i className="fas fa-exclamation-triangle text-6xl text-red-500 mb-4"></i>
                                <h1 className="text-2xl font-bold text-gray-800 mb-4">ì‹œìŠ¤í…œ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤</h1>
                                <p className="text-gray-600 mb-6">
                                    {this.state.error?.message || 'ì˜ˆìƒì¹˜ ëª»í•œ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤'}
                                </p>
                                <div className="space-y-3">
                                    <button 
                                        onClick={() => window.location.reload()} 
                                        className="w-full px-6 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors"
                                    >
                                        <i className="fas fa-redo mr-2"></i>í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨
                                    </button>
                                    <button 
                                        onClick={() => window.location.href = '/'} 
                                        className="w-full px-6 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors"
                                    >
                                        <i className="fas fa-home mr-2"></i>í™ˆìœ¼ë¡œ ì´ë™
                                    </button>
                                </div>
                                
                                {ENV.isDevelopment && (
                                    <details className="mt-6 p-4 bg-gray-100 rounded text-left">
                                        <summary className="cursor-pointer font-medium">ê°œë°œì ì •ë³´</summary>
                                        <div className="mt-2 space-y-2">
                                            <div>
                                                <strong>ì—ëŸ¬:</strong>
                                                <pre className="text-xs bg-white p-2 rounded mt-1 overflow-auto">
                                                    {this.state.error?.stack}
                                                </pre>
                                            </div>
                                            {this.state.errorInfo && (
                                                <div>
                                                    <strong>ì»´í¬ë„ŒíŠ¸ ìŠ¤íƒ:</strong>
                                                    <pre className="text-xs bg-white p-2 rounded mt-1 overflow-auto">
                                                        {this.state.errorInfo.componentStack}
                                                    </pre>
                                                </div>
                                            )}
                                        </div>
                                    </details>
                                )}
                            </div>
                        </div>
                    );
                }

                return this.props.children;
            }
        }

        // ì•Œë¦¼ ì»´í¬ë„ŒíŠ¸ (ê°œì„ ë¨)
        const Notification = ({ message, type = 'info', onClose, duration = 5000 }) => {
            useEffect(() => {
                const timer = setTimeout(onClose, duration);
                return () => clearTimeout(timer);
            }, [onClose, duration]);

            const types = {
                success: { bg: 'bg-green-500', icon: 'fa-check-circle' },
                error: { bg: 'bg-red-500', icon: 'fa-times-circle' },
                warning: { bg: 'bg-yellow-500', icon: 'fa-exclamation-triangle' },
                info: { bg: 'bg-blue-500', icon: 'fa-info-circle' }
            };

            const config = types[type] || types.info;

            return (
                <div 
                    className={`fixed top-4 right-4 ${config.bg} text-white px-6 py-3 rounded-lg shadow-lg notification z-50 max-w-sm`}
                    role="alert"
                    aria-live="assertive"
                >
                    <div className="flex items-start space-x-3">
                        <i className={`fas ${config.icon} mt-0.5 flex-shrink-0`} aria-hidden="true"></i>
                        <div className="flex-1">
                            <p className="text-sm leading-5 break-words">{message}</p>
                        </div>
                        <button 
                            onClick={onClose} 
                            className="text-white hover:text-gray-200 flex-shrink-0 ml-2"
                            aria-label="ì•Œë¦¼ ë‹«ê¸°"
                        >
                            <i className="fas fa-times"></i>
                        </button>
                    </div>
                </div>
            );
        };

        // ë¡œë”© ì»´í¬ë„ŒíŠ¸ (ê°œì„ ë¨)
        const Loading = ({ message = "ë¡œë”© ì¤‘...", progress }) => (
            <div className="flex justify-center items-center min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100">
                <div className="text-center max-w-md" role="status" aria-live="polite">
                    <div className="loading-spinner mx-auto mb-4" aria-hidden="true"></div>
                    <p className="text-gray-600 text-lg font-medium">{message}</p>
                    <p className="text-sm text-gray-500 mt-2">ì‹œìŠ¤í…œì„ ì¤€ë¹„í•˜ê³  ìˆìŠµë‹ˆë‹¤</p>
                    
                    {progress && (
                        <div className="mt-4 w-64 bg-gray-200 rounded-full h-2 mx-auto">
                            <div 
                                className="bg-blue-600 h-2 rounded-full transition-all duration-500 ease-out"
                                style={{ width: `${progress}%` }}
                                aria-valuenow={progress}
                                aria-valuemin="0"
                                aria-valuemax="100"
                                role="progressbar"
                            ></div>
                        </div>
                    )}
                </div>
            </div>
        );

        // ClubCard ì»´í¬ë„ŒíŠ¸ (JSX êµ¬ë¬¸ ì˜¤ë¥˜ ìˆ˜ì •)
        const ClubCard = ({ club, onSelect, isSelected, priority }) => {
            const getAvailabilityColor = () => {
                if (club.availability_status === 'full') return 'bg-red-100 text-red-800';
                if (club.availability_status === 'near_full') return 'bg-yellow-100 text-yellow-800';
                return 'bg-green-100 text-green-800';
            };

            const getPriorityBadge = () => {
                if (!priority) return null;
                const colors = {
                    1: 'bg-red-500',
                    2: 'bg-yellow-500', 
                    3: 'bg-green-500'
                };
                return (
                    <div className={`absolute top-2 right-2 ${colors[priority]} text-white text-xs px-2 py-1 rounded-full font-bold`}>
                        {priority}ì§€ë§
                    </div>
                );
            };

            return (
                <div 
                    className={`club-card bg-white rounded-lg shadow-md p-4 relative preload-content ${isSelected ? 'ring-2 ring-blue-500 bg-blue-50' : ''}`}
                    onClick={() => onSelect(club)}
                    role="button"
                    tabIndex={0}
                    onKeyPress={(e) => { if (e.key === 'Enter') onSelect(club); }}
                >
                    {getPriorityBadge()}
                    
                    <div className="mb-3">
                        <h3 className="text-lg font-bold text-gray-800 mb-1">{club.name}</h3>
                        <p className="text-sm text-gray-600 mb-2">{club.teacher} ì„ ìƒë‹˜</p>
                        <p className="text-xs text-blue-600 font-medium">{club.category}</p>
                    </div>

                    <div className="mb-3">
                        <p className="text-sm text-gray-700 line-clamp-2">{club.description}</p>
                    </div>

                    <div className="flex justify-between items-center mb-2">
                        <div className="text-sm text-gray-600">
                            <i className="fas fa-users mr-1"></i>
                            {club.current_members || 0}/{club.max_capacity || club.max_members}ëª…
                        </div>
                        <span className={`px-2 py-1 rounded-full text-xs font-medium ${getAvailabilityColor()}`}>
                            {club.availability_status === 'full' ? 'ì •ì›ë§ˆê°' :
                             club.availability_status === 'near_full' ? 'ë§ˆê°ì„ë°•' : 'ì‹ ì²­ê°€ëŠ¥'}
                        </span>
                    </div>

                    <div className="text-xs text-gray-500 space-y-1">
                        <div><i className="fas fa-map-marker-alt mr-1"></i>{club.location}</div>
                        <div><i className="fas fa-clock mr-1"></i>{club.meeting_time}</div>
                    </div>

                    <div className="mt-3 pt-3 border-t border-gray-200">
                        <button 
                            className="w-full text-blue-600 hover:text-blue-800 text-sm font-medium transition-colors"
                            onClick={(e) => {
                                e.stopPropagation();
                                onSelect(club);
                            }}
                        >
                            <i className="fas fa-info-circle mr-1"></i>ìƒì„¸ë³´ê¸°
                        </button>
                    </div>
                </div>
            );
        };

        // ClubDetailModal ì»´í¬ë„ŒíŠ¸ (JSX êµ¬ë¬¸ ì˜¤ë¥˜ ìˆ˜ì •)
        const ClubDetailModal = ({ club, isOpen, onClose, onApply }) => {
            if (!isOpen || !club) return null;

            return (
                <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4 modal-backdrop">
                    <div className="bg-white rounded-lg max-w-2xl w-full max-h-screen overflow-y-auto">
                        <div className="sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex justify-between items-center">
                            <h2 className="text-xl font-bold text-gray-800">{club.name}</h2>
                            <button 
                                onClick={onClose}
                                className="text-gray-400 hover:text-gray-600 text-xl"
                                aria-label="ë‹«ê¸°"
                            >
                                <i className="fas fa-times"></i>
                            </button>
                        </div>

                        <div className="p-6 space-y-6">
                            {/* ê¸°ë³¸ ì •ë³´ */}
                            <div className="grid grid-cols-2 gap-4">
                                <div>
                                    <h3 className="font-semibold text-gray-700 mb-2">ë‹´ë‹¹ êµì‚¬</h3>
                                    <p className="text-gray-600">{club.teacher} ì„ ìƒë‹˜</p>
                                </div>
                                <div>
                                    <h3 className="font-semibold text-gray-700 mb-2">ëª¨ì§‘ ì •ì›</h3>
                                    <p className="text-gray-600">{club.max_capacity || club.max_members}ëª… (ìµœì†Œ {club.min_members}ëª…)</p>
                                </div>
                                <div>
                                    <h3 className="font-semibold text-gray-700 mb-2">í™œë™ ì¥ì†Œ</h3>
                                    <p className="text-gray-600">{club.location}</p>
                                </div>
                                <div>
                                    <h3 className="font-semibold text-gray-700 mb-2">í™œë™ ì‹œê°„</h3>
                                    <p className="text-gray-600">{club.meeting_time}</p>
                                </div>
                            </div>

                            {/* í˜„ì¬ ì‹ ì²­ í˜„í™© */}
                            <div>
                                <h3 className="font-semibold text-gray-700 mb-2">ì‹ ì²­ í˜„í™©</h3>
                                <div className="bg-gray-50 p-4 rounded-lg">
                                    <div className="flex justify-between items-center mb-2">
                                        <span>í˜„ì¬ ì‹ ì²­ì: {club.current_members || 0}ëª…</span>
                                        <span className="text-sm text-gray-600">
                                            {Math.round(((club.current_members || 0) / (club.max_capacity || club.max_members)) * 100)}% ë‹¬ì„±
                                        </span>
                                    </div>
                                    <div className="w-full bg-gray-200 rounded-full h-2">
                                        <div 
                                            className="bg-blue-600 h-2 rounded-full progress-bar"
                                            style={{ width: `${Math.min(((club.current_members || 0) / (club.max_capacity || club.max_members)) * 100, 100)}%` }}
                                        ></div>
                                    </div>
                                </div>
                            </div>

                            {/* í™œë™ ì„¤ëª… */}
                            <div>
                                <h3 className="font-semibold text-gray-700 mb-2">í™œë™ ì†Œê°œ</h3>
                                <p className="text-gray-600 leading-relaxed">{club.description}</p>
                            </div>

                            {/* ì£¼ìš” í™œë™ */}
                            {club.activities && (
                                <div>
                                    <h3 className="font-semibold text-gray-700 mb-2">ì£¼ìš” í™œë™</h3>
                                    <p className="text-gray-600 leading-relaxed">{club.activities}</p>
                                </div>
                            )}

                            {/* í™œë™ ëª©í‘œ */}
                            {club.goals && (
                                <div>
                                    <h3 className="font-semibold text-gray-700 mb-2">í™œë™ ëª©í‘œ</h3>
                                    <p className="text-gray-600 leading-relaxed">{club.goals}</p>
                                </div>
                            )}

                            {/* ì§€ì› ìê²© */}
                            {club.requirements && (
                                <div>
                                    <h3 className="font-semibold text-gray-700 mb-2">ì§€ì› ìê²©</h3>
                                    <p className="text-gray-600 leading-relaxed">{club.requirements}</p>
                                </div>
                            )}
                        </div>

                        {/* í•˜ë‹¨ ë²„íŠ¼ - JSX êµ¬ë¬¸ ì˜¤ë¥˜ ìˆ˜ì • */}
                        <div className="sticky bottom-0 bg-white border-t border-gray-200 px-6 py-4">
                            <div className="flex space-x-3">
                                <button
                                    onClick={onClose}
                                    className="flex-1 px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors"
                                >
                                    ë‹«ê¸°
                                </button>
                                <button
                                    onClick={() => {
                                        onApply(club, 'first');
                                        onClose();
                                    }}
                                    className="flex-1 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors"
                                    disabled={club.availability_status === 'full'}
                                >
                                    <i className="fas fa-heart mr-2"></i>1ì§€ë§ ì„ íƒ
                                </button>
                                <button
                                    onClick={() => {
                                        onApply(club, 'second');
                                        onClose();
                                    }}
                                    className="flex-1 px-4 py-2 bg-yellow-600 text-white rounded-lg hover:bg-yellow-700 transition-colors"
                                    disabled={club.availability_status === 'full'}
                                >
                                    <i className="fas fa-star mr-2"></i>2ì§€ë§ ì„ íƒ
                                </button>
                                <button
                                    onClick={() => {
                                        onApply(club, 'third');
                                        onClose();
                                    }}
                                    className="flex-1 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors"
                                    disabled={club.availability_status === 'full'}
                                >
                                    <i className="fas fa-plus mr-2"></i>3ì§€ë§ ì„ íƒ
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        // LoginRegister ì»´í¬ë„ŒíŠ¸ëŠ” ê¸°ì¡´ê³¼ ë™ì¼í•˜ê²Œ ìœ ì§€...
        // ë‚˜ë¨¸ì§€ ì»´í¬ë„ŒíŠ¸ë“¤ì€ ë‹¤ìŒ ë‹¨ê³„ì—ì„œ ê³„ì†...

        // React ì•± ë Œë”ë§ ì‹œì‘
        const App = () => {
            const [user, setUser] = useState(null);
            const [loading, setLoading] = useState(true);
            const [systemStatus, setSystemStatus] = useState('checking');
            const [initProgress, setInitProgress] = useState(0);

            useEffect(() => {
                const initializeApp = async () => {
                    try {
                        setInitProgress(20);
                        console.log('ğŸ”„ ì‹œìŠ¤í…œ ì´ˆê¸°í™” ì‹œì‘');
                        
                        // ì‹œìŠ¤í…œ ìƒíƒœ í™•ì¸
                        await api.checkHealth();
                        setInitProgress(50);
                        setSystemStatus('healthy');
                        console.log('âœ… ì„œë²„ ìƒíƒœ ì–‘í˜¸');
                        
                        setInitProgress(70);
                        
                        // ê¸°ì¡´ ë¡œê·¸ì¸ ìƒíƒœ í™•ì¸
                        const token = localStorage.getItem('token');
                        const userData = localStorage.getItem('user');
                        
                        if (token && userData) {
                            try {
                                const parsedUser = JSON.parse(userData);
                                setUser(parsedUser);
                                console.log('âœ… ê¸°ì¡´ ë¡œê·¸ì¸ ìƒíƒœ ë³µì›:', parsedUser.name);
                            } catch (error) {
                                console.warn('âš ï¸ ì˜ëª»ëœ ì‚¬ìš©ì ë°ì´í„°, ì´ˆê¸°í™”:', error);
                                localStorage.removeItem('token');
                                localStorage.removeItem('user');
                            }
                        }
                        
                        setInitProgress(100);
                    } catch (error) {
                        console.error('âŒ ì‹œìŠ¤í…œ ì´ˆê¸°í™” ì‹¤íŒ¨:', error);
                        setSystemStatus('unhealthy');
                    } finally {
                        setTimeout(() => setLoading(false), 500);
                    }
                };

                initializeApp();
            }, []);

            const handleLogin = useCallback((userData) => {
                setUser(userData);
                console.log('âœ… ë¡œê·¸ì¸ ì„±ê³µ:', userData.name, userData.role);
            }, []);

            const handleLogout = useCallback(() => {
                localStorage.removeItem('token');
                localStorage.removeItem('user');
                setUser(null);
                console.log('ğŸ‘‹ ë¡œê·¸ì•„ì›ƒ ì™„ë£Œ');
            }, []);

            if (loading) {
                return <Loading message="ì‹œìŠ¤í…œ ì´ˆê¸°í™” ì¤‘..." progress={initProgress} />;
            }

            if (systemStatus === 'unhealthy') {
                return (
                    <div className="min-h-screen bg-gray-50 flex items-center justify-center p-4">
                        <div className="text-center max-w-md">
                            <i className="fas fa-exclamation-triangle text-6xl text-red-500 mb-4" aria-hidden="true"></i>
                            <h1 className="text-2xl font-bold text-gray-800 mb-2">ì‹œìŠ¤í…œ ì ê²€ ì¤‘</h1>
                            <p className="text-gray-600 mb-6">
                                í˜„ì¬ ì„œë²„ ì ê²€ì´ ì§„í–‰ ì¤‘ì…ë‹ˆë‹¤.<br/>
                                ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.
                            </p>
                            <div className="space-y-3">
                                <button 
                                    onClick={() => window.location.reload()}
                                    className="w-full px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors"
                                >
                                    <i className="fas fa-redo mr-2" aria-hidden="true"></i>ë‹¤ì‹œ ì‹œë„
                                </button>
                                {ENV.isDevelopment && (
                                    <a 
                                        href="/init-database"
                                        target="_blank"
                                        rel="noopener noreferrer"
                                        className="w-full px-6 py-2 bg-yellow-600 text-white rounded-lg hover:bg-yellow-700 transition-colors inline-block"
                                    >
                                        <i className="fas fa-database mr-2" aria-hidden="true"></i>DB ì´ˆê¸°í™”
                                    </a>
                                )}
                            </div>
                        </div>
                    </div>
                );
            }

            // ì„ì‹œë¡œ ê°„ë‹¨í•œ í™”ë©´ë§Œ í‘œì‹œ
            return (
                <ErrorBoundary>
                    <ConnectionStatus />
                    <main id="main-content">
                        <div className="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center">
                            <div className="text-center">
                                <h1 className="text-3xl font-bold text-gray-800 mb-4">ì˜¤ì„±ì¤‘í•™êµ ë™ì•„ë¦¬ ì‹œìŠ¤í…œ</h1>
                                <p className="text-gray-600 mb-8">JSX êµ¬ë¬¸ ì˜¤ë¥˜ê°€ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤!</p>
                                <div className="bg-white p-6 rounded-lg shadow-md">
                                    <p className="text-green-600 font-medium">âœ… ì‹œìŠ¤í…œì´ ì •ìƒì ìœ¼ë¡œ ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤</p>
                                </div>
                            </div>
                        </div>
                    </main>
                </ErrorBoundary>
            );
        };

        // React ì•± ë Œë”ë§
        try {
            console.log('ğŸ¨ React ì•± ë Œë”ë§ ì‹œì‘');
            ReactDOM.render(<App />, document.getElementById('root'));
            console.log('âœ… React ì•± ë Œë”ë§ ì™„ë£Œ');
        } catch (error) {
            console.error('âŒ React ì•± ë Œë”ë§ ì‹¤íŒ¨:', error);
            
            // í˜ì¼ì„¸ì´í”„ UI
            const rootElement = document.getElementById('root');
            const errorFallback = document.getElementById('error-fallback');
            
            if (rootElement && errorFallback) {
                rootElement.style.display = 'none';
                errorFallback.style.display = 'flex';
            }
        }
    </script>
</body>
</html>
